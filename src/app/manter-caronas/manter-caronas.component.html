<section>
    <main>
        <app-header></app-header>
    </main>
</section>

<div class="container">

    <div class="form-row" id="consulta-local">
        <div class="form-group col-lg-5">
            <input [(ngModel)]="consultaDestino" (blur)="consultarDestino(consultaDestino)" id="con-destino" name="con-destino" type="search" placeholder="Pesquisar destino desejado" class="form-control input-md" maxlength="100" autocomplete="off">
        </div>
    </div>

    <div class="form-group col-md-12">
        <div class="table-overflow">
            <table class="table table-bordered-sm table-hover table-active" id="tabela">
                <thead class="table-dark">
                    <tr>
                        <th scope="col">Data</th>
                        <th scope="col">Horário</th>
                        <th scope="col">Local de Saída</th>
                        <th scope="col">Local de Destino</th>
                        <th scope="col">Contribuição</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let rota of rotas" (click)="consultarRota(rota.verificador)">
                        <td>{{ rota.data }}</td>
                        <td>{{ rota.horario }}</td>
                        <td>{{ rota.inicio }}</td>
                        <td>{{ rota.fim }}</td>
                        <td>{{ rota.contribuicao.tipo }} - {{ rota.contribuicao.valor }}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="row">
        <div class="col-12 text-center mt-5">
            <h2>Registrar Carona</h2>
        </div>
    </div>

    <div class="form-row" id="consulta">
        <div class="form-group col-lg-2">
            <label for="con-carona">CONSULTAR</label>
            <input [(ngModel)]="consultaCarona" (blur)="consultarCarona(consultaCarona)" id="con-carona" name="con-carona" type="search" minlength="8" maxlength="8" autocomplete="off" placeholder="Código Verificador" class="form-control input-md" required="">
        </div>
    </div>

    <div class="row justify-content-center mt-5 mb-5">
        <div class="col-sm-12 col-md-12 col-lg-12">
            <form id="form" #frm="ngForm">
                <div class="form-row">
                    <div class="form-group col-lg-2">
                        <label for="codVerificador">Rota</label>
                        <input [(ngModel)]="carona.rota.verificador" (blur)="consultarRota($event.target.value)" id="codVerificador" name="codVerificador" autocomplete="off" type="text" class="form-control input-md" readonly=“true” required />
                    </div>
                    <div class="form-group col-lg-2">
                        <label for="cpf">Usuário(CPF)</label>
                        <input [(ngModel)]="carona.usuario.cpf" (blur)="consultarUsuario($event.target.value)" id="cpf" name="cpf" placeholder="XXX.XXX.XXX-XX" autocomplete="off" class="form-control input-md" type="text" minlength="11" maxlength="11" pattern="[0-9]+$" required
                        />
                    </div>
                    <div class="form-group col-lg-2">
                        <label for="acompanhantes">Acompanhantes</label>
                        <input [(ngModel)]="carona.acompanhantes" id="acompanhantes" name="acompanhantes" placeholder="Nº acompanhantes" min="0" max="30" class="form-control input-md" type="number" required />
                    </div>
                    <div class="form-group col-lg-3">
                        <label for="contribuicao">Contribuição</label>
                        <select [(ngModel)]="carona.contribuicao.id" id="contribuicao" name="contribuicao" class="form-control" required>
                            <option *ngFor="let contribuicao of contribuicoes" value="{{ contribuicao.id }}">{{ contribuicao.tipo }}
                                -
                                {{ contribuicao.valor }}</option>
                        </select>
                    </div>
                    <div class="form-group col-lg-2">
                        <button type="button" class="btn btn-info" routerLink="/manter-contribuições" id="add-cont">
                            <svg width="32px" height="22px" viewBox="0 0 16 16" class="bi bi-plus-circle" fill="currentColor"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd"
                                    d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                <path fill-rule="evenodd"
                                    d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                            </svg>
                        </button>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group col-lg-2">
                        <label for="data">Horário</label>
                        <input [(ngModel)]="carona.horario_aproximado" id="horario" name="horario" placeholder="00:00:00" class="form-control input-md" autocomplete="off" type="time" required />
                    </div>
                    <div class="form-group col-lg-6">
                        <label for="pontoEncontro">Ponto de Encontro</label>
                        <input [(ngModel)]="carona.ponto_encontro" id="pontoEncontro" name="pontoEncontro" type="text" placeholder="colocar ponto de encontro preferivel" minlength="10" maxlength="80" autocomplete="off" class="form-control input-md" required />
                    </div>
                    <div class="form-group col-lg-2">
                        <label for="situacao">Situação</label>
                        <input [(ngModel)]="carona.situacao" id="situacao" name="situacao" type="text" readonly=“true” placeholder="situação da carona" autocomplete="off" class="form-control input-md" required />
                    </div>
                </div>
                <div class="container">
                    <button type="button" class="btn btn-success medio" (click)="salvar()" [disabled]="frm.invalid">Salvar</button>
                    <button type="button" class="btn btn-danger medio" (click)="excluir(carona.id)" [disabled]="frm.invalid">Remover</button>
                    <button type="button" class="btn btn-secondary medio" (click)="limpar()">Limpar</button>
                </div>
            </form>
        </div>
    </div>
</div>